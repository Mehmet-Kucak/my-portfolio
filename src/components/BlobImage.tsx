"use client";

import React, { useState, useEffect } from "react";
import { motion } from "framer-motion";

const shapes: string[] = [
  "M240.2 -193.6C291.2 -127.6 298.7 -28.9 277.6 63.2C256.4 155.3 206.8 240.7 135.4 271.3C64 301.9 -29 277.7 -107 235.1C-185 192.6 -248 131.8 -276.5 50.6C-305.1 -30.6 -299.1 -132.2 -247.3 -198.4C-195.5 -264.5 -97.7 -295.3 -1.6 -294C94.6 -292.8 189.2 -259.6 240.2 -193.6",
  "M198.8 -167.5C250.9 -93.1 281.9 -10.8 268 65.5C254 141.9 195.1 212.4 122.0 244.1C48.9 275.7 -38.5 268.5 -121.3 235.1C-204.1 201.6 -282.4 142.0 -310.1 59.7C-337.7 -22.6 -314.7 -127.6 -254.5 -203.8C-194.4 -280.0 -97.2 -327.5 -12.0 -318.0C73.3 -308.5 146.6 -241.9 198.8 -167.5",
  "M236.1 -173.7C296.1 -113.1 327.9 -15.5 308.5 70.8C289.2 157.2 218.6 232.2 131.5 274.8C44.4 317.4 -59.2 327.7 -135.8 288.3C-212.5 249.0 -262.2 160.1 -276.7 70.6C-291.1 -18.8 -270.3 -108.9 -218.3 -167.6C-166.3 -226.3 -83.1 -253.8 2.5 -255.8C88.1 -257.8 176.2 -234.2 236.1 -173.7",
  "M241.9 -192.1C288.4 -134.7 283.6 -35.5 255.6 46.9C227.7 129.2 176.5 194.8 103.7 238.9C31.0 282.9 -63.5 305.4 -133.5 273.2C-203.4 241.0 -248.9 154.1 -270.4 61.3C-291.9 -31.5 -289.4 -130.1 -240.4 -188.2C-191.3 -246.3 -95.6 -263.8 1.0 -264.6C97.7 -265.4 195.5 -249.6 241.9 -192.1",
  "M254.3 -200.6C313.1 -129.0 333.0 -24.2 308.2 64.7C283.4 153.7 214.0 226.9 131.9 261.8C49.8 296.7 -45.0 293.4 -122.4 255.6C-199.7 217.7 -259.8 145.4 -273.1 67.8C-286.5 -9.8 -253.2 -92.6 -199.9 -162.9C-146.6 -233.2 -73.3 -291.1 12.2 -300.9C97.7 -310.6 195.5 -272.2 254.3 -200.6",
  "M243.8 -196.4C293.2 -132.5 294.8 -32.4 273.3 62.6C251.8 157.7 207.3 247.8 137.5 278.8C67.8 309.7 -27.1 281.6 -113.7 238.8C-200.3 196.1 -278.6 138.8 -298.2 64.6C-317.9 -9.5 -279.0 -100.5 -219.5 -166.7C-160.0 -232.9 -80.0 -274.5 8.6 -281.3C97.2 -288.2 194.4 -260.4 243.8 -196.4",
  "M235.5 -175.7C296.5 -111.4 331.0 -14.0 313.9 75.8C296.7 165.5 227.7 247.7 143.4 282.2C59.2 316.8 -40.5 303.9 -112.7 259.4C-184.8 214.9 -229.5 138.7 -254.9 51.4C-280.3 -36.0 -286.3 -134.6 -240.6 -195.4C-194.9 -256.1 -97.5 -279.1 -5.1 -275.0C87.3 -271.0 174.6 -239.9 235.5 -175.7",
  "M248.8 -197.7C302.0 -131.5 310.9 -29.3 289.1 65.9C267.3 161.0 214.8 249.0 139.6 282.2C64.5 315.3 -33.3 293.7 -106.0 248.0C-178.8 202.3 -226.5 132.4 -251.2 50.0C-275.8 -32.5 -277.5 -127.5 -231.8 -192.0C-186.1 -256.4 -93.0 -290.2 2.3 -292.1C97.7 -293.9 195.5 -263.9 248.8 -197.7",
  "M235.5 -187.2C281.8 -129.7 279.8 -33.2 259.7 60.9C239.5 154.9 201.1 246.4 132.5 282.1C63.9 317.7 -34.9 297.6 -119.3 254.4C-203.8 211.2 -274.0 144.9 -297.2 62.4C-320.4 -20.2 -296.6 -118.9 -239.3 -178.9C-181.9 -238.8 -91.0 -260.0 1.8 -261.5C94.6 -262.9 189.2 -244.6 235.5 -187.2",
  "M240.2 -193.6C291.2 -127.6 298.7 -28.9 277.6 63.2C256.4 155.3 206.8 240.7 135.4 271.3C64 301.9 -29 277.7 -107 235.1C-185 192.6 -248 131.8 -276.5 50.6C-305.1 -30.6 -299.1 -132.2 -247.3 -198.4C-195.5 -264.5 -97.7 -295.3 -1.6 -294C94.6 -292.8 189.2 -259.6 240.2 -193.6",
];

const transition = {
  duration: shapes.length,
  repeat: Infinity,
  repeatType: "loop" as const,
  ease: "linear" as const,
};

interface BlobProps {
  src: string;
  alt: string;
  outline?: {
    color: string;
    width: number;
  };
}

export default function Blob({
  src,
  alt,
  outline = { color: "#FFFFFF", width: 10 },
}: BlobProps) {
  const [mounted, setMounted] = useState(false);
  useEffect(() => void setMounted(true), []);

  if (!mounted) {
    return;
  }

  return (
    <motion.svg
      viewBox="-350 -350 700 700"
      xmlns="http://www.w3.org/2000/svg"
      role="img"
      aria-label={alt}
      className="w-full h-auto max-w-md"
      whileHover={{
        scale: 1.05,
        transition: { duration: 0.2 },
      }}
      whileTap={{ scale: 0.95, transition: { duration: 0.2 } }}
    >
      <defs>
        <filter id="blob-shadow" x="-50%" y="-50%" width="200%" height="200%">
          <feDropShadow
            dx="0"
            dy="5"
            stdDeviation="10"
            floodColor="#ff0000"
            floodOpacity="1"
          />
        </filter>
        <clipPath id="blob-clip">
          <motion.path
            fill="none"
            stroke="none"
            animate={{ d: shapes }}
            transition={transition}
          />
        </clipPath>
      </defs>

      <image
        href={src}
        x={-350}
        y={-350}
        width={700}
        height={700}
        preserveAspectRatio="xMidYMid slice"
        clipPath="url(#blob-clip)"
      />

      <motion.path
        d={shapes[0]}
        fill="none"
        stroke={outline.color}
        strokeWidth={outline.width}
        strokeLinejoin="round"
        strokeLinecap="round"
        animate={{ d: shapes }}
        transition={transition}
      />
    </motion.svg>
  );
}
